---
// src/components/common/Card.astro
// Reusable card component with soft, minimal grey design

export interface Props {
  /** Visual variant of the card */
  variant?: "default" | "elevated" | "outlined" | "flat";
  /** Whether the card has hover effects */
  hoverable?: boolean;
  /** Whether the card is clickable (adds cursor pointer) */
  clickable?: boolean;
  /** Optional link to make the entire card clickable */
  href?: string;
  /** Additional CSS classes */
  class?: string;
  /** HTML tag to render (article by default) */
  as?: "article" | "div" | "section" | "aside";
  /** Data attributes for GPA or other metadata */
  "data-gpa-en"?: string;
  "data-gpa-fr"?: string;
}

const {
  variant = "default",
  hoverable = true,
  clickable = false,
  href,
  class: className = "",
  as: Tag = "article",
  "data-gpa-en": gpaEn,
  "data-gpa-fr": gpaFr,
} = Astro.props;

const variantClasses = {
  default: "card-default",
  elevated: "card-elevated",
  outlined: "card-outlined",
  flat: "card-flat",
};

const classes = [
  "card",
  variantClasses[variant],
  hoverable && "card-hoverable",
  clickable && "card-clickable",
  href && "card-link",
  className,
]
  .filter(Boolean)
  .join(" ");

const dataAttrs = {
  ...(gpaEn && { "data-gpa-en": gpaEn }),
  ...(gpaFr && { "data-gpa-fr": gpaFr }),
};
---

{
  href ? (
    <a href={href} class={classes} {...dataAttrs}>
      <slot />
    </a>
  ) : (
    <Tag class={classes} {...dataAttrs}>
      <slot />
    </Tag>
  )
}

<style>
  .card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 0;
    padding: 1.25rem;
    margin: 0.75rem 0;
    display: block;
    transition:
      transform 0.2s ease,
      box-shadow 0.2s ease,
      border-color 0.2s ease,
      background-color 0.2s ease;
  }

  /* Default variant - subtle shadow */
  .card-default {
    background: var(--card);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  }

  /* Elevated variant - slightly more prominent */
  .card-elevated {
    background: var(--card);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  /* Outlined variant - no shadow, just border */
  .card-outlined {
    background: transparent;
    box-shadow: none;
  }

  /* Flat variant - minimal styling */
  .card-flat {
    background: var(--bg-elev);
    box-shadow: none;
    border-color: transparent;
  }

  /* Hoverable state - white border on dark theme */
  .card-hoverable:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    border-color: var(--text);
  }

  /* Clickable state */
  .card-clickable {
    cursor: pointer;
  }

  /* Link card */
  .card-link {
    text-decoration: none;
    color: inherit;
    display: block;
  }

  .card-link:hover {
    text-decoration: none;
  }

  /* Focus state for accessibility */
  .card:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  /* Light theme adjustments */
  :global([data-theme="light"]) .card {
    background: var(--card);
    border-color: var(--border);
  }

  :global([data-theme="light"]) .card-default {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
  }

  :global([data-theme="light"]) .card-elevated {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
  }

  :global([data-theme="light"]) .card-hoverable:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    border-color: var(--text);
  }

  :global([data-theme="light"]) .card-flat {
    background: var(--bg-elev);
  }

  /* Touch device optimizations */
  @media (hover: none) and (pointer: coarse) {
    .card-hoverable:hover {
      transform: none;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      border-color: var(--border);
    }

    .card-hoverable:active {
      transform: scale(0.99);
      border-color: var(--text);
    }
  }

  /* Responsive padding adjustments */
  @media (max-width: 768px) {
    .card {
      padding: 1rem;
      margin: 0.6rem 0;
    }
  }

  @media (max-width: 480px) {
    .card {
      padding: 0.9rem;
      margin: 0.5rem 0;
    }
  }
</style>
