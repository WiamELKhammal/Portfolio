---
// src/components/sections/Skills.astro
import Section from "../common/Section.astro";
import { skillsData, getSkillLogo } from "../../data/skills"; // Import the helper
import type { SkillCategory } from "../../types";

export interface Props {
  skills?: SkillCategory[];
  class?: string;
}

const { skills = skillsData, class: className = "" } = Astro.props;
---

<Section id="skills" title="Technical Skills" class={className}>
  <div class="skills-grid">
    {
      skills.map((category) => (
        <article class="skill-card">
          <header class="card-header">
            <span class="card-icon">
              <i class={category.icon} />
            </span>
            <h3 class="card-title">{category.name}</h3>
          </header>
          <div class="tech-list">
            {category.skills.map((skill) => (
              <span class="tech-chip">
                {/* 1. Add the image tag here */}
                <img 
                  src={getSkillLogo(skill)} 
                  alt={`${skill} logo`} 
                  class="skill-logo" 
                />
                {skill}
              </span>
            ))}
          </div>
        </article>
      ))
    }
  </div>
</Section>

<style>
  /* ... keep your existing CSS ... */

  /* 2. Add these styles for the logos */
  .skill-logo {
    width: 16px;
    height: 16px;
    margin-right: 8px;
    object-fit: contain;
    /* Optional: adds a slight brightness for dark themes if icons are too dark */
    filter: grayscale(20%); 
    transition: filter 0.2s ease;
  }

  .tech-chip:hover .skill-logo {
    filter: grayscale(0%);
    transform: scale(1.1);
  }

  .tech-chip {
    display: inline-flex;
    align-items: center; /* Ensures logo and text align */
    padding: 0.35rem 0.65rem;
    /* ... rest of your styles ... */
  }
</style>

<style>
  /* Grid layout */
  .skills-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }

  /* Category card - Minimalist design */
  .skill-card {
    background: transparent;
    border: 1px solid var(--border);
    padding: 1.25rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    transition:
      background-color 0.2s ease,
      border-color 0.2s ease;
  }

  .skill-card:hover {
    background: var(--bg-elev);
    border-color: var(--muted);
  }

  /* Card header */
  .card-header {
    display: flex;
    align-items: center;
    gap: 0.625rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border);
  }

  .card-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    color: var(--muted);
    font-size: 0.95rem;
    flex-shrink: 0;
    transition: color 0.2s ease;
  }

  .skill-card:hover .card-icon {
    color: var(--text);
  }

  .card-title {
    margin: 0;
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text);
    letter-spacing: -0.01em;
  }

  /* Tech chips */
  .tech-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.45rem;
  }

  .tech-chip {
    display: inline-flex;
    align-items: center;
    padding: 0.35rem 0.65rem;
    background: var(--bg-elev);
    border: 1px solid var(--border);
    color: var(--muted);
    font-size: 0.75rem;
    font-weight: 500;
    transition:
      border-color 0.2s ease,
      color 0.2s ease;
  }

  .tech-chip:hover {
    border-color: var(--text);
    color: var(--text);
  }

  /* Light theme */
  :global([data-theme="light"]) .skill-card:hover {
    background: var(--bg-elev);
    border-color: var(--muted);
  }

  :global([data-theme="light"]) .skill-card:hover .card-icon {
    color: var(--text);
  }

  :global([data-theme="light"]) .tech-chip:hover {
    border-color: var(--text);
    color: var(--text);
  }

  /* Tablet - 2 columns */
  @media (max-width: 1024px) {
    .skills-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 0.875rem;
    }

    .skill-card {
      padding: 1.125rem;
    }
  }

  /* Mobile - 1 column */
  @media (max-width: 640px) {
    .skills-grid {
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }

    .skill-card {
      padding: 1rem;
      gap: 0.875rem;
    }

    .card-header {
      padding-bottom: 0.625rem;
      gap: 0.5rem;
    }

    .card-icon {
      width: 28px;
      height: 28px;
      font-size: 0.875rem;
    }

    .card-title {
      font-size: 0.875rem;
    }

    .tech-list {
      gap: 0.375rem;
    }

    .tech-chip {
      padding: 0.3rem 0.55rem;
      font-size: 0.7rem;
    }
  }

  /* Touch devices */
  @media (hover: none) and (pointer: coarse) {
    .skill-card:hover {
      background: transparent;
      border-color: var(--border);
    }

    .skill-card:hover .card-icon {
      color: var(--muted);
    }

    .skill-card:active {
      background: var(--bg-elev);
      border-color: var(--muted);
    }

    .skill-card:active .card-icon {
      color: var(--text);
    }

    .tech-chip:hover {
      border-color: var(--border);
      color: var(--muted);
    }

    .tech-chip:active {
      border-color: var(--text);
      color: var(--text);
    }
  }
</style>
