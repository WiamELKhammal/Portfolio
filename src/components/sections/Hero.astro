---
// src/components/sections/Hero.astro
// Hero section component with minimal, subtle quote design

import Button from "../common/Button.astro";
import { heroData } from "../../data/about";

export interface Props {
  /** Main title text */
  title?: string;
  /** Role/subtitle with typing animation */
  subtitle?: string;
  /** Description paragraph */
  description?: string;
  /** Inspirational quote */
  quote?: string;
  /** Primary CTA button text */
  ctaText?: string;
  /** Primary CTA button link */
  ctaLink?: string;
  /** Secondary CTA button text (typically download) */
  downloadText?: string;
  /** Secondary CTA button link */
  downloadLink?: string;
  /** Additional CSS classes */
  class?: string;
}

const {
  title = heroData.title,
  subtitle = heroData.subtitle,
  description = heroData.description,
  quote = heroData.quote,
  ctaText = heroData.cta.primary.text,
  ctaLink = heroData.cta.primary.href,
  downloadText = heroData.cta.secondary?.text,
  downloadLink = heroData.cta.secondary?.href,
  class: className = "",
} = Astro.props;

const downloadFileName = downloadLink?.split("/").pop();
---

<section
  class:list={["hero", "section", "container", className]}
  aria-label="Introduction"
>
  <div class="hero-content">
    {
      quote && (
        <div class="hero-tagline reveal">
          <p class="hero-quote">
            <span class="quote-text">{quote}</span>
          </p>
        </div>
      )
    }

    <h1 class="reveal defer-on-scroll">{title}</h1>

    {
      subtitle && (
        <div class="hero-role reveal delay-1" aria-live="polite">
          <span id="role-typer">{subtitle}</span>
          <span id="role-cursor" aria-hidden="true">
            |
          </span>
        </div>
      )
    }

    {
      description && (
        <p class="hero-description muted reveal delay-2">{description}</p>
      )
    }

    <div class="hero-cta reveal delay-3">
      {
        ctaText && ctaLink && (
          <Button href={ctaLink} variant="primary">
            {ctaText}
          </Button>
        )
      }
      {
        downloadText && downloadLink && (
          <Button
            href={downloadLink}
            variant="ghost"
            download={downloadFileName}
            external
            class="btn-download"
          >
            {downloadText}
          </Button>
        )
      }
    </div>

    <a class="scroll-down" href="#about" aria-label="Scroll to About">
      <span aria-hidden="true">â†“</span>
    </a>
  </div>
</section>

<style>
  .hero {
    min-height: 68vh;
    display: grid;
    place-items: center;
  }

  .hero-content {
    text-align: center;
    max-width: 800px;
  }

  .hero h1 {
    font-size: clamp(2rem, 1.4rem + 2.2vw, 3rem);
    line-height: 1.1;
    margin: 0.2rem 0 0.6rem;
  }

  .hero-description {
    max-width: 70ch;
    margin-left: auto;
    margin-right: auto;
  }

  .hero-cta {
    display: flex;
    justify-content: center;
    gap: 0.8rem;
    margin-top: 1rem;
    flex-wrap: wrap;
  }

  /* Hero quote - subtle, minimal design */
  .hero-tagline {
    margin-bottom: 1.25rem;
  }

  .hero-quote {
    margin: 0;
    font-size: 0.9rem;
    font-style: italic;
    color: var(--muted);
    letter-spacing: 0.02em;
    opacity: 0.7;
  }

  .quote-text {
    font-weight: 400;
  }

  .quote-text::before {
    content: '"';
    opacity: 0.5;
  }

  .quote-text::after {
    content: '"';
    opacity: 0.5;
  }

  /* Role with typing animation - Hacker style */
  .hero-role {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.2rem;
    font-size: clamp(1.1rem, 1rem + 0.5vw, 1.4rem);
    color: var(--text);
    margin-bottom: 1rem;
    font-family: var(--font-mono);
    letter-spacing: 0.05em;
  }

  #role-typer {
    font-weight: 500;
    overflow: hidden;
    border-right: 2px solid var(--text);
    white-space: nowrap;
    animation:
      typing 2.5s steps(30, end) forwards,
      blink-border 0.75s step-end infinite;
    animation-delay: 0.5s, 0.5s;
    max-width: 0;
  }

  #role-cursor {
    display: none;
  }

  @keyframes typing {
    from {
      max-width: 0;
    }
    to {
      max-width: 100%;
    }
  }

  @keyframes blink-border {
    0%,
    50% {
      border-color: var(--text);
    }
    51%,
    100% {
      border-color: transparent;
    }
  }

  /* Scroll down indicator */
  .scroll-down {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    margin-top: 2rem;
    color: var(--muted);
    text-decoration: none;
    font-size: 1.2rem;
    border: 1px solid var(--border);
    border-radius: 50%;
    transition: all 0.3s ease;
    animation: bounce 2s infinite;
  }

  .scroll-down:hover {
    color: var(--text);
    border-color: var(--text);
    transform: translateY(2px);
  }

  @keyframes bounce {
    0%,
    20%,
    50%,
    80%,
    100% {
      transform: translateY(0);
    }
    40% {
      transform: translateY(-6px);
    }
    60% {
      transform: translateY(-3px);
    }
  }

  /* Reveal animations */
  .reveal {
    opacity: 0;
    transform: translateY(10px);
    transition:
      opacity 0.6s ease,
      transform 0.6s ease;
  }

  .reveal.in {
    opacity: 1;
    transform: translateY(0);
  }

  .delay-1 {
    transition-delay: 0.08s;
  }
  .delay-2 {
    transition-delay: 0.16s;
  }
  .delay-3 {
    transition-delay: 0.24s;
  }

  /* Light theme adjustments */
  :global([data-theme="light"]) .hero-quote {
    color: var(--muted);
    opacity: 0.6;
  }

  :global([data-theme="light"]) .hero-role {
    color: var(--text);
  }

  :global([data-theme="light"]) #role-typer {
    border-right-color: var(--text);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .hero {
      min-height: 60vh;
      padding-top: 4rem;
      padding-bottom: 3rem;
    }

    .hero h1 {
      font-size: clamp(1.8rem, 1.2rem + 2vw, 2.5rem);
    }

    .hero-cta {
      flex-direction: column;
      align-items: center;
    }

    .hero-cta :global(.btn) {
      width: 100%;
      max-width: 280px;
    }

    .scroll-down {
      margin-top: 1.5rem;
    }

    .hero-quote {
      font-size: 0.85rem;
    }
  }

  @media (max-width: 480px) {
    #role-typer {
      white-space: normal !important;
      max-width: none !important;
      animation: none !important;
      border-right: none !important;
      display: block;
      text-align: center;
    }

    .hero-role {
      /* Center the block since the cursor is gone */
      justify-content: center;
      width: 100%;
    }
  }
</style>

<script>
  // Trigger reveal animations on load
  document.addEventListener("DOMContentLoaded", () => {
    const reveals = document.querySelectorAll(".hero .reveal");

    // Stagger the reveal animations
    reveals.forEach((el, index) => {
      setTimeout(
        () => {
          el.classList.add("in");
        },
        index * 100 + 100,
      );
    });
  });
</script>
