---
// src/components/sections/Achievements.astro
// Achievements section with carousel matching Projects carousel exactly

import Section from "../common/Section.astro";
import Badge from "../common/Badge.astro";
import { achievementsData } from "../../data/achievements";
import type { AchievementEntry } from "../../types";

export interface Props {
  /** Custom achievements data (overrides default) */
  achievements?: AchievementEntry[];
  /** Whether to show the carousel navigation */
  showNavigation?: boolean;
  /** Additional CSS classes */
  class?: string;
}

const {
  achievements = achievementsData,
  showNavigation = true,
  class: className = "",
} = Astro.props;

// Helper to determine badge variant based on content
function getBadgeVariant(badge: string): "prize" | "rank" | "type" | "bonus" | "winner" | "default" {
  const lowerBadge = badge.toLowerCase();
  if (lowerBadge.includes("prize") || lowerBadge.includes("$")) return "prize";
  if (
    lowerBadge.includes("winner") ||
    lowerBadge.includes("champion") ||
    lowerBadge.includes("1st place") ||
    (lowerBadge.includes("1st") && !lowerBadge.includes("21st") && !lowerBadge.includes("31st"))
  ) return "winner";
  if (
    lowerBadge.includes("rank") ||
    lowerBadge.includes("#") ||
    lowerBadge.includes("2nd") ||
    lowerBadge.includes("3rd") ||
    lowerBadge.includes("place")
  ) return "rank";
  if (
    lowerBadge.includes("team") ||
    lowerBadge.includes("solo") ||
    lowerBadge.includes("certified") ||
    lowerBadge.includes("professional") ||
    lowerBadge.includes("open source") ||
    lowerBadge.includes("community")
  ) return "type";
  if (
    lowerBadge.includes("gift") ||
    lowerBadge.includes("bonus")
  ) return "bonus";

  return "default";
}

// Helper to determine if achievement is a winner achievement
function isWinnerAchievement(achievement: AchievementEntry): boolean {
  const searchText = [
    achievement.title.toLowerCase(),
    ...achievement.badges.map(b => b.toLowerCase())
  ].join(" ");
  
  return searchText.includes("winner") || 
         searchText.includes("champion") || 
         searchText.includes("1st place") ||
         searchText.includes("1st") ||
         searchText.includes("#1");
}
---

<Section id="achievements" title="Achievements" class={className}>
  <div class="ach-carousel">
    <div class="ach-viewport">
      <div class="ach-track" id="ach-track">
        {
          achievements.map((achievement) => {
            const cardContent = (
              <>
                <div class="tile-body">
                  <h3>{achievement.title}</h3>
                  <div class="card-meta">
                    <span class="meta-item">{achievement.organization}</span>
                    <span class="meta-separator">Â·</span>
                    <span class="meta-item">{achievement.location}</span>
                  </div>
                  <p class="muted">{achievement.description}</p>
                  {achievement.highlights.length > 0 && (
                    <ul class="highlights-list">
                      {achievement.highlights.map((highlight) => (
                        <li>{highlight}</li>
                      ))}
                    </ul>
                  )}
                  <div class="kw-list">
                    {achievement.badges.map((badge) => {
                      const variant = getBadgeVariant(badge);
                      return (
                        <span class:list={["achievement-badge", `badge-${variant}`]}>
                          {variant === "winner" && (
                            <i class="fa-solid fa-crown" aria-hidden="true" />
                          )}
                          {variant === "prize" && (
                            <i class="fa-solid fa-trophy" aria-hidden="true" />
                          )}
                          {variant === "rank" && (
                            <i class="fa-solid fa-medal" aria-hidden="true" />
                          )}
                          {variant === "bonus" && (
                            <i class="fa-solid fa-gift" aria-hidden="true" />
                          )}
                          {badge}
                        </span>
                      );
                    })}
                  </div>
                </div>
                <div class="tile-foot">
                  <div class="skills-row">
                    {achievement.skills.slice(0, 4).map((skill) => (
                      <Badge variant="default" size="sm" hoverable={false}>
                        {skill}
                      </Badge>
                    ))}
                    {achievement.skills.length > 4 && (
                      <Badge variant="muted" size="sm" hoverable={false}>
                        +{achievement.skills.length - 4}
                      </Badge>
                    )}
                  </div>
                  {achievement.url && (
                    <div class="external-link-indicator">
                      <i class="fa-solid fa-arrow-up-right-from-square" aria-hidden="true" />
                    </div>
                  )}
                </div>
              </>
            );

            const isWinner = isWinnerAchievement(achievement);
            const cardClasses = isWinner 
              ? "tile achievement-card winner-achievement" 
              : "tile achievement-card";
            const linkClasses = isWinner
              ? "tile achievement-card achievement-card-link winner-achievement"
              : "tile achievement-card achievement-card-link";

            return achievement.url ? (
              <a
                href={achievement.url}
                target="_blank"
                rel="noopener noreferrer"
                class={linkClasses}
                aria-label={`View ${achievement.title} on external site`}
              >
                {cardContent}
              </a>
            ) : (
              <article class={cardClasses}>
                {cardContent}
              </article>
            );
          })
        }
      </div>
    </div>

    {showNavigation && achievements.length > 1 && (
      <nav class="ach-nav" aria-label="Achievements carousel navigation">
        <div class="ach-indicators" id="ach-indicators">
          <!-- Arrows and indicators will be generated by JavaScript -->
        </div>
      </nav>
    )}
  </div>
</Section>

<style>
  /* Carousel container */
  .ach-carousel {
    position: relative;
    width: 100%;
  }

  /* Viewport clips the overflow */
  .ach-viewport {
    overflow: hidden;
    width: 100%;
    padding: 0.5rem 0;
  }

  /* Track holds all cards and slides */
  .ach-track {
    display: flex;
    gap: 24px;
    transition: transform 0.4s cubic-bezier(0.25, 0.1, 0.25, 1);
    will-change: transform;
  }

  /* Achievement card styling */
  .achievement-card {
    flex: 0 0 calc((100% - 48px) / 3);
    min-width: 280px;
    max-width: 400px;
    border: 1px solid var(--border);
    background: var(--card);
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
    transition:
      transform 0.25s ease,
      box-shadow 0.25s ease,
      border-color 0.25s ease;
    text-decoration: none;
    color: inherit;
  }

  /* Clickable card specific styles */
  .achievement-card-link {
    cursor: pointer;
    position: relative;
  }

  .achievement-card-link:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    border-color: var(--accent);
  }

  .achievement-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
    border-color: var(--text);
  }

  .achievement-card:focus-visible {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  /* Winner Achievement Styles - Subtle */
  .winner-achievement {
    position: relative;
    background: var(--card);
    border: 1px solid color-mix(in oklab, #fbbf24 40%, var(--border));
    box-shadow: 0 0 12px rgba(251, 191, 36, 0.15);
  }

  .winner-achievement:hover {
    transform: translateY(-3px);
    border-color: color-mix(in oklab, #fbbf24 60%, var(--border));
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2),
                0 0 20px rgba(251, 191, 36, 0.25);
  }

  .winner-achievement.achievement-card-link:hover {
    border-color: #fbbf24;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2),
                0 0 24px rgba(251, 191, 36, 0.3);
  }

  /* Accessibility: Reduce motion */
  @media (prefers-reduced-motion: reduce) {
    .badge-winner {
      animation: none;
      box-shadow: 0 0 8px rgba(251, 191, 36, 0.3);
    }
  }

  /* Card content */
  .tile-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .tile-body h3 {
    margin: 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text);
    line-height: 1.3;
  }

  /* Meta info - small and gray */
  .card-meta {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    flex-wrap: wrap;
  }

  .meta-item {
    font-size: 0.8rem;
    color: var(--muted);
  }

  .meta-separator {
    font-size: 0.75rem;
    color: var(--muted);
    opacity: 0.5;
  }

  .tile-body .muted {
    font-size: 0.9rem;
    line-height: 1.5;
    color: var(--muted);
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Highlights list */
  .highlights-list {
    margin: 0;
    padding-left: 1rem;
    list-style: disc;
    font-size: 0.85rem;
    color: var(--text);
  }

  .highlights-list li {
    margin: 0.2rem 0;
    line-height: 1.45;
  }

  .highlights-list li::marker {
    color: var(--muted);
  }

  /* Keywords/tags list */
  .kw-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
    margin-top: auto;
    padding-top: 0.5rem;
  }

  /* Achievement badges */
  .achievement-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    padding: 0.2rem 0.5rem;
    font-size: 0.7rem;
    font-weight: 500;
  }

  .achievement-badge i {
    font-size: 0.6rem;
  }

  .badge-default {
    background: var(--bg-elev);
    border: 1px solid var(--border);
    color: var(--muted);
  }

  .badge-prize {
    background: color-mix(in oklab, #f59e0b 12%, var(--bg-elev));
    border: 1px solid color-mix(in oklab, #f59e0b 40%, var(--border));
    color: #f59e0b;
  }

  .badge-prize i {
    color: #f59e0b;
  }

  .badge-rank {
    background: color-mix(in oklab, var(--accent) 12%, var(--bg-elev));
    border: 1px solid color-mix(in oklab, var(--accent) 40%, var(--border));
    color: var(--accent);
  }

  .badge-rank i {
    color: var(--accent);
  }

  .badge-bonus {
    background: color-mix(in oklab, #10b981 12%, var(--bg-elev)); /* adapt to bonus/green */
    border: 1px solid color-mix(in oklab, #10b981 40%, var(--border));
    color: #10b981;
  }

  .badge-bonus i {
    color: #10b981;
  }

  .badge-type {
    background: var(--bg-elev);
    border: 1px solid var(--border);
    color: var(--text);
  }

  .badge-winner {
    background: linear-gradient(135deg, 
      color-mix(in oklab, #fbbf24 20%, var(--bg-elev)) 0%, 
      color-mix(in oklab, #f59e0b 20%, var(--bg-elev)) 100%
    );
    border: 1px solid #fbbf24;
    color: #fbbf24;
    font-weight: 600;
    box-shadow: 0 0 8px rgba(251, 191, 36, 0.3);
    animation: winner-badge-glow 2s ease-in-out infinite;
  }

  .badge-winner i {
    color: #fbbf24;
    filter: drop-shadow(0 0 2px rgba(251, 191, 36, 0.5));
  }

  @keyframes winner-badge-glow {
    0%, 100% {
      box-shadow: 0 0 8px rgba(251, 191, 36, 0.3);
      border-color: #fbbf24;
    }
    50% {
      box-shadow: 0 0 12px rgba(251, 191, 36, 0.5),
                  0 0 20px rgba(251, 191, 36, 0.2);
      border-color: #f59e0b;
    }
  }

  /* Card footer */
  .tile-foot {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    padding-top: 0.5rem;
    border-top: 1px solid var(--border);
    margin-top: auto;
  }

  .skills-row {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
    flex: 1;
  }

  /* External link indicator */
  .external-link-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    background: var(--bg-elev);
    border: 1px solid var(--border);
    border-radius: 4px;
    color: var(--muted);
    flex-shrink: 0;
    transition:
      background-color 0.2s ease,
      border-color 0.2s ease,
      color 0.2s ease;
  }

  .external-link-indicator i {
    font-size: 0.75rem;
  }

  .achievement-card-link:hover .external-link-indicator {
    background: var(--accent);
    border-color: var(--accent);
    color: var(--bg);
  }

  /* Navigation container */
  .ach-nav {
    display: flex;
    justify-content: center;
    margin-top: 1.5rem;
  }

  .ach-indicators {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  /* Arrow buttons (generated by JS) */
  :global(.ach-arrow) {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    background: var(--bg-elev);
    border: 1px solid var(--border);
    color: var(--text);
    cursor: pointer;
    transition:
      background-color 0.2s ease,
      border-color 0.2s ease,
      color 0.2s ease,
      opacity 0.2s ease;
  }

  :global(.ach-arrow:hover) {
    border-color: var(--text);
    background: var(--bg);
  }

  :global(.ach-arrow:disabled) {
    opacity: 0.4;
    cursor: not-allowed;
  }

  :global(.ach-arrow:focus-visible) {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  /* Indicator buttons (generated by JS) */
  :global(.ach-indicator) {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    height: 32px;
    padding: 0 0.5rem;
    background: var(--bg-elev);
    border: 1px solid var(--border);
    color: var(--muted);
    font-size: 0.8rem;
    font-weight: 600;
    cursor: pointer;
    transition:
      background-color 0.2s ease,
      border-color 0.2s ease,
      color 0.2s ease;
  }

  :global(.ach-indicator:hover) {
    border-color: var(--text);
    color: var(--text);
  }

  :global(.ach-indicator.active) {
    background: var(--text);
    border-color: var(--text);
    color: var(--bg);
  }

  :global(.ach-indicator:focus-visible) {
    outline: 2px solid var(--accent);
    outline-offset: 2px;
  }

  /* Light theme adjustments */
  :global([data-theme="light"]) .achievement-card {
    background: var(--card);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  }

  :global([data-theme="light"]) .achievement-card:hover {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    border-color: var(--text);
  }

  :global([data-theme="light"]) .achievement-card-link:hover {
    border-color: var(--accent);
  }

  :global([data-theme="light"]) .external-link-indicator {
    background: var(--bg-elev);
    border-color: var(--border);
  }

  :global([data-theme="light"]) .achievement-card-link:hover .external-link-indicator {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
  }

  :global([data-theme="light"]) .badge-prize {
    background: color-mix(in oklab, #f59e0b 10%, var(--bg-elev));
    color: #d97706;
  }

  :global([data-theme="light"]) .badge-prize i {
    color: #d97706;
  }

  :global([data-theme="light"]) :global(.ach-arrow) {
    background: var(--bg-elev);
    border-color: var(--border);
  }

  :global([data-theme="light"]) :global(.ach-arrow:hover) {
    border-color: var(--text);
  }

  :global([data-theme="light"]) :global(.ach-indicator) {
    background: var(--bg-elev);
  }

  :global([data-theme="light"]) :global(.ach-indicator.active) {
    background: var(--text);
    color: var(--bg);
  }

  /* Light theme winner adjustments */
  :global([data-theme="light"]) .winner-achievement {
    background: var(--card);
    border-color: color-mix(in oklab, #f59e0b 50%, var(--border));
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06),
                0 0 12px rgba(217, 119, 6, 0.15);
  }

  :global([data-theme="light"]) .winner-achievement:hover {
    border-color: #f59e0b;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(217, 119, 6, 0.25);
  }

  :global([data-theme="light"]) .badge-winner {
    background: linear-gradient(135deg, 
      color-mix(in oklab, #f59e0b 25%, var(--bg-elev)) 0%, 
      color-mix(in oklab, #d97706 25%, var(--bg-elev)) 100%
    );
    border-color: #f59e0b;
    color: #d97706;
    box-shadow: 0 0 8px rgba(217, 119, 6, 0.25);
  }

  :global([data-theme="light"]) .badge-winner i {
    color: #d97706;
    filter: drop-shadow(0 0 2px rgba(217, 119, 6, 0.4));
  }

  @keyframes winner-badge-glow-light {
    0%, 100% {
      box-shadow: 0 0 8px rgba(217, 119, 6, 0.25);
      border-color: #f59e0b;
    }
    50% {
      box-shadow: 0 0 12px rgba(217, 119, 6, 0.4),
                  0 0 20px rgba(217, 119, 6, 0.15);
      border-color: #d97706;
    }
  }

  :global([data-theme="light"]) .badge-winner {
    animation: winner-badge-glow-light 2s ease-in-out infinite;
  }

  @media (prefers-reduced-motion: reduce) {
    :global([data-theme="light"]) .badge-winner {
      animation: none;
    }
  }

  /* Responsive - Tablet */
  @media (max-width: 1024px) {
    .achievement-card {
      flex: 0 0 calc((100% - 24px) / 2);
    }
  }

  /* Responsive - Mobile */
  @media (max-width: 768px) {
    .ach-viewport {
      overflow-x: auto;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
      scroll-snap-type: x mandatory;
    }

    .ach-viewport::-webkit-scrollbar {
      display: none;
    }

    .ach-track {
      gap: 1rem;
      padding: 0 0.5rem;
    }

    .achievement-card {
      flex: 0 0 85%;
      max-width: none;
      scroll-snap-align: start;
    }

    .ach-nav {
      display: none; /* Hide navigation on mobile, use swipe instead */
    }
  }

  @media (max-width: 480px) {
    .achievement-card {
      flex: 0 0 90%;
      padding: 0.9rem;
    }

    .tile-body h3 {
      font-size: 1rem;
    }

    .tile-body .muted {
      font-size: 0.85rem;
      -webkit-line-clamp: 2;
    }

    .kw-list {
      gap: 0.3rem;
    }

    .highlights-list {
      font-size: 0.8rem;
      padding-left: 0.9rem;
    }

    .achievement-badge {
      padding: 0.15rem 0.4rem;
      font-size: 0.65rem;
    }
  }

  /* Touch device optimizations */
  @media (hover: none) and (pointer: coarse) {
    .achievement-card:hover {
      transform: none;
      box-shadow: none;
    }

    .achievement-card:active {
      transform: scale(0.99);
    }

    .achievement-card-link:active {
      transform: scale(0.98);
    }

    .achievement-card-link:active .external-link-indicator {
      background: var(--accent);
      border-color: var(--accent);
      color: var(--bg);
    }
  }

  /* Desktop - restore JS-controlled carousel */
  @media (min-width: 769px) {
    .ach-viewport {
      overflow: hidden;
    }

    .ach-track {
      transform: translateX(0);
    }
  }
</style>

<script>
  // Achievements carousel functionality with arrows and numbered indicators
  function initAchievementsCarousel() {
    let currentAchIndex = 0;
    const track = document.getElementById("ach-track");
    const indicatorsContainer = document.getElementById("ach-indicators");

    if (!track) return;

    const cards = track.querySelectorAll(".achievement-card");
    const totalCards = cards.length;

    if (totalCards === 0) return;

    // Calculate how many cards to show at once based on screen size
    function getCardsToShow(): number {
      if (window.innerWidth < 768) return 1;
      if (window.innerWidth < 1024) return 2;
      return 3;
    }

    // Generate numbered indicators with arrows
    function generateIndicators(): void {
      if (!indicatorsContainer || totalCards === 0) return;

      const cardsToShow = getCardsToShow();
      let totalIndicators: number;

      if (totalCards <= cardsToShow) {
        totalIndicators = 1;
      } else {
        totalIndicators = totalCards - cardsToShow + 1;
      }

      indicatorsContainer.innerHTML = "";

      // Add previous arrow
      const prevArrow = document.createElement("button");
      prevArrow.className = "ach-arrow prev";
      prevArrow.id = "ach-prev";
      prevArrow.setAttribute("aria-label", "Previous achievement");
      prevArrow.innerHTML = '<i class="fa-solid fa-chevron-left"></i>';

      prevArrow.addEventListener("click", () => {
        currentAchIndex = Math.max(0, currentAchIndex - 1);
        updateCarousel();
      });

      indicatorsContainer.appendChild(prevArrow);

      // Add indicator buttons
      for (let i = 0; i < totalIndicators; i++) {
        const indicator = document.createElement("button");
        indicator.className = "ach-indicator";
        indicator.setAttribute("data-index", String(i));
        indicator.setAttribute("aria-label", `Go to achievement position ${i + 1}`);
        indicator.textContent = String(i + 1);

        if (i === currentAchIndex) {
          indicator.classList.add("active");
        }

        indicator.addEventListener("click", () => {
          currentAchIndex = i;
          updateCarousel();
        });

        indicatorsContainer.appendChild(indicator);
      }

      // Add next arrow
      const nextArrow = document.createElement("button");
      nextArrow.className = "ach-arrow next";
      nextArrow.id = "ach-next";
      nextArrow.setAttribute("aria-label", "Next achievement");
      nextArrow.innerHTML = '<i class="fa-solid fa-chevron-right"></i>';

      nextArrow.addEventListener("click", () => {
        const cardsToShow = getCardsToShow();
        const maxIndex = totalCards <= cardsToShow ? 0 : totalCards - cardsToShow;
        currentAchIndex = Math.min(maxIndex, currentAchIndex + 1);
        updateCarousel();
      });

      indicatorsContainer.appendChild(nextArrow);
    }

    function updateCarousel(): void {
      if (!track) return;
      
      const cardsToShow = getCardsToShow();
      const maxIndex = totalCards <= cardsToShow ? 0 : totalCards - cardsToShow;

      // Clamp index
      currentAchIndex = Math.min(Math.max(0, currentAchIndex), maxIndex);

      // Calculate offset
      const firstCard = cards[0] as HTMLElement;
      const cardWidth = firstCard?.offsetWidth || 0;
      const gap = 24; // matches CSS gap
      const offset = currentAchIndex * (cardWidth + gap);

      track.style.transform = `translateX(-${offset}px)`;

      // Update button states
      const prevBtn = document.getElementById("ach-prev") as HTMLButtonElement;
      const nextBtn = document.getElementById("ach-next") as HTMLButtonElement;

      if (prevBtn) prevBtn.disabled = currentAchIndex === 0;
      if (nextBtn) nextBtn.disabled = currentAchIndex >= maxIndex;

      // Update indicators
      updateIndicators();
    }

    function updateIndicators(): void {
      const indicators = indicatorsContainer?.querySelectorAll(".ach-indicator");
      if (!indicators) return;

      indicators.forEach((indicator, index) => {
        if (index === currentAchIndex) {
          indicator.classList.add("active");
        } else {
          indicator.classList.remove("active");
        }
      });
    }

    // Add keyboard navigation support
    document.addEventListener("keydown", (e) => {
      // Only handle if carousel is visible and in viewport
      const rect = track.getBoundingClientRect();
      const isVisible = rect.top < window.innerHeight && rect.bottom > 0;

      if (!isVisible) return;

      // Check if we're focused on or near the achievements section
      const section = document.getElementById("achievements");
      if (!section) return;

      const sectionRect = section.getBoundingClientRect();
      const isSectionInView = sectionRect.top < window.innerHeight / 2 && sectionRect.bottom > window.innerHeight / 2;

      if (!isSectionInView) return;

      if (e.key === "ArrowLeft") {
        currentAchIndex = Math.max(0, currentAchIndex - 1);
        updateCarousel();
      } else if (e.key === "ArrowRight") {
        const cardsToShow = getCardsToShow();
        const maxIndex = totalCards <= cardsToShow ? 0 : totalCards - cardsToShow;
        currentAchIndex = Math.min(maxIndex, currentAchIndex + 1);
        updateCarousel();
      }
    });

    // Initialize
    generateIndicators();
    updateCarousel();

    // Update on window resize (debounced)
    let resizeTimeout: ReturnType<typeof setTimeout>;
    window.addEventListener("resize", () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(() => {
        generateIndicators();
        updateCarousel();
      }, 150);
    });
  }

  // Initialize when DOM is ready
  document.addEventListener("DOMContentLoaded", initAchievementsCarousel);

  // Also initialize on Astro page transitions
  document.addEventListener("astro:page-load", initAchievementsCarousel);
</script>
